---
pr:
  type: select
  proxies: &1
  - 节点选择
  - 自定义美国
  - 自定义HK日本  
  - 香港
  - 台湾
  - 日本
  - 新加坡
  - 美国
  - 其它地区
  - 全部节点
  - 自动选择
  - DIRECT
p:
  type: http
  interval: 3600
  health-check:
    enable: true
    url: https://cp.cloudflare.com
    interval: 300
    timeout: 1000
    tolerance: 100
use:
  type: url-test
  use: &2
  - 订阅一
  - 订阅二
proxy-providers:
  订阅一:
    type: http
    path: "./proxy_provider/订阅一.yaml"
    url: https://example.com/airport?type=clashmeta&protocol=shadowsocks&rule=default
    interval: 3600
    health-check:
      enable: true
      url: https://cp.cloudflare.com
      interval: 300
  订阅二:
    type: http
    path: "./proxy_provider/订阅二.yaml"
    url: https://example.com/api/v1/client/subscribe?token=ilovechina
    interval: 3600
    health-check:
      enable: true
      url: https://cp.cloudflare.com
      interval: 300
rule-providers:
  AWAvenue-Ads:
    type: http
    behavior: domain
    format: yaml
    path: "./rule_provider/AWAvenue-Ads.yaml"
    url: https://ghfast.top/https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/refs/heads/main/Filters/AWAvenue-Ads-Rule-Clash-Classical.yaml
    interval: 600
mode: rule
ipv6: true
log-level: info
allow-lan: true
mixed-port: 7890
unified-delay: true
tcp-concurrent: true
external-controller: :9090
geodata-mode: true
geox-url:
  geoip: https://ghfast.top/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat
  geosite: https://ghfast.top/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat
  mmdb: https://ghfast.top/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb
find-process-mode: strict
keep-alive-interval: 1800
global-client-fingerprint: random
profile:
  store-selected: true
  store-fake-ip: true
ntp:
  enable: true
  write-to-system: false
  server: time.apple.com
  port: 123
  interval: 30
sniffer:
  enable: true
  sniff:
    TLS:
      ports:
      - 443
      - 8443
    HTTP:
      ports:
      - 80
      - 8080-8880
      override-destination: true
tun:
  enable: false
  stack: system
  dns-hijack:
  - any:53
  - tcp://any:53
  auto-route: true
  auto-detect-interface: true
dns:
  enable: true
  listen: :1053
  ipv6: true
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter:
  - "*"
  - "+.lan"
  - "+.local"
  default-nameserver:
  - 223.5.5.5
  - 119.29.29.29
  - 114.114.114.114
  - "[2402:4e00::]"
  - "[2400:3200::1]"
  nameserver:
  - tls://8.8.4.4#dns
  - tls://1.0.0.1#dns
  - tls://[2001:4860:4860::8844]#dns
  - tls://[2606:4700:4700::1001]#dns
  proxy-server-nameserver:
  - https://doh.pub/dns-query
  nameserver-policy:
    geosite:cn,private:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    geosite:!cn,!private:
    - tls://dns.google
    - tls://cloudflare-dns.com
proxy-groups:
- name: 节点选择
  type: select
  proxies:
  - 全部节点
  - 自动选择
  - 自定义美国
  - 自定义HK日本    
  - 香港
  - 台湾
  - 日本
  - 新加坡
  - 美国
  - 其它地区
  - DIRECT
- name: dns
  type: select
  proxies: *1
- name: 广告拦截
  type: select
  proxies:
  - REJECT
  - DIRECT
  - 节点选择
- name: 境外AI
  type: select
  proxies: *1
- name: Apple
  type: select
  proxies: *1
- name: Google
  type: select
  proxies: *1
- name: Telegram
  type: select
  proxies: *1
- name: Twitter
  type: select
  proxies: *1
- name: Pixiv
  type: select
  proxies: *1
- name: ehentai
  type: select
  proxies: *1
- name: 巴哈姆特
  type: select
  proxies: *1
- name: YouTube
  type: select
  proxies: *1
- name: NETFLIX
  type: select
  proxies: *1
- name: TikTok
  type: select
  proxies: *1
- name: Spotify
  type: select
  proxies: *1
- name: Github
  type: select
  proxies: *1
- name: Steam
  type: select
  proxies: *1
- name: OneDrive
  type: select
  proxies: *1
- name: 微软服务
  type: select
  proxies: *1
- name: 国内
  type: select
  proxies:
  - DIRECT
  - 节点选择
  - 香港
  - 台湾
  - 日本
  - 新加坡
  - 美国
  - 其它地区
  - 全部节点
  - 自动选择
- name: 其他
  type: select
  proxies: *1
- name: 香港
  type: url-test
  use: *2
  filter: "(?i)港|hk|hongkong|hong kong"
- name: 台湾
  type: url-test
  use: *2
  filter: "(?i)台|tw|taiwan"
- name: 日本
  type: url-test
  use: *2
  filter: "(?i)日本|jp|japan"
- name: 美国
  type: url-test
  use: *2
  filter: "(?i)美|us|unitedstates|united states"
- name: 新加坡
  type: url-test
  use: *2
  filter: "(?i)(新|sg|singapore)"
- name: 其它地区
  type: url-test
  use: *2
  filter: "(?i)^(?!.*(?:\U0001F1ED\U0001F1F0|\U0001F1EF\U0001F1F5|\U0001F1FA\U0001F1F8|\U0001F1F8\U0001F1EC|\U0001F1E8\U0001F1F3|港|hk|hongkong|台|tw|taiwan|日|jp|japan|新|sg|singapore|美|us|unitedstates)).*"
- name: 全部节点
  type: url-test
  use: *2
- name: 自动选择
  type: url-test
  use: *2
  tolerance: 2
rules:
- RULE-SET,AWAvenue-Ads,广告拦截
- GEOSITE,category-scholar-!cn,境外AI
- GEOSITE,apple,Apple
- GEOSITE,apple-cn,Apple
- GEOSITE,ehentai,ehentai
- GEOSITE,github,Github
- GEOSITE,twitter,Twitter
- GEOSITE,youtube,YouTube
- GEOSITE,google,Google
- GEOSITE,google-cn,Google
- GEOSITE,telegram,Telegram
- GEOSITE,netflix,NETFLIX
- GEOSITE,tiktok,TikTok
- GEOSITE,bahamut,巴哈姆特
- GEOSITE,spotify,Spotify
- GEOSITE,pixiv,Pixiv
- GEOSITE,steam@cn,DIRECT
- GEOSITE,steam,Steam
- GEOSITE,onedrive,OneDrive
- GEOSITE,microsoft,微软服务
- GEOSITE,geolocation-!cn,其他
- GEOIP,google,Google
- GEOIP,netflix,NETFLIX
- GEOIP,telegram,Telegram
- GEOIP,twitter,Twitter
- GEOSITE,CN,国内
- GEOIP,CN,国内
- IP-CIDR,10.0.0.0/8,DIRECT
- IP-CIDR,172.16.0.0/12,DIRECT
- IP-CIDR,192.168.0.0/16,DIRECT
- IP-CIDR,100.64.0.0/10,DIRECT
- IP-CIDR,127.0.0.0/8,DIRECT
- MATCH,其他
- RULE-SET,cnvideo_domain,直连

# 规则集
## type：可选http/file/inline  behavior：可选domain/ipcidr/classical format：可选yaml/text/mrs
rule-anchor:
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
  class: &class {type: http, interval: 86400, behavior: classical, format: text}
rule-providers: 

  cnvideo_domain: { <<: *domain, url: "https://github.com/haygcao/ClashRule/raw/refs/heads/main/Rule/cnvideo.list"}
  
  private_ip: {<<: *ip, url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/private.mrs"}
